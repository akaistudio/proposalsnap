<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>ProposalSnap ‚Äî Admin</title>
<link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600;700;800&display=swap" rel="stylesheet">
<style>
:root{--a1:#f59e0b}

*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'DM Sans',sans-serif;background:#0B0F1A;color:#E8ECF4;min-height:100vh}
.topbar{background:#141926;border-bottom:1px solid #2A3148;padding:14px 24px;display:flex;align-items:center;justify-content:space-between;position:sticky;top:0;z-index:100}
.topbar-left{display:flex;align-items:center;gap:16px}
.topbar h1{font-size:18px;font-weight:800;color:#fff;text-decoration:none}
.badge-admin{background:linear-gradient(135deg,#f59e0b,#ea580c);color:#fff;font-size:10px;font-weight:700;padding:3px 8px;border-radius:20px;letter-spacing:.5px}
.topbar-right{display:flex;align-items:center;gap:6px}
.topbar-right a{font-size:13px;color:#8B95B0;text-decoration:none;padding:7px 14px;border-radius:8px;transition:.15s;font-weight:500}
.topbar-right a:hover{background:#2A3148;color:#fff}
.topbar-right a.suite{border:1px solid #2A3148;font-size:12px}
.main{max-width:1200px;margin:0 auto;padding:28px 24px}
.page-header{margin-bottom:28px}
.page-header h2{font-size:24px;font-weight:800;color:#fff;letter-spacing:-.5px}
.page-header p{font-size:14px;color:#8B95B0;margin-top:4px}
.platform-stats{display:grid;grid-template-columns:repeat(auto-fit,minmax(150px,1fr));gap:14px;margin-bottom:32px}
.stat{background:#141926;border-radius:12px;padding:18px 20px;border:1px solid #2A3148;position:relative;overflow:hidden}
.stat::after{content:'';position:absolute;top:0;left:0;width:3px;height:100%}
.stat .s-label{font-size:11px;font-weight:600;color:#8B95B0;text-transform:uppercase;letter-spacing:.5px;margin-bottom:6px}
.stat .s-val{font-size:26px;font-weight:800;color:#fff}
.stat .s-sub{font-size:11px;color:#8B95B0;margin-top:4px}
.stat.a1::after{background:var(--a1)}
.stat.a2::after{background:#4ADE80}
.stat.a3::after{background:#3B82F6}
.stat.a4::after{background:#F59E0B}
.stat.a5::after{background:#F87171}
.section-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:16px}
.section-header h3{font-size:16px;font-weight:700;color:#fff}
.section-header .count{font-size:13px;color:#8B95B0;background:#2A3148;padding:3px 10px;border-radius:20px}
.companies-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(290px,1fr));gap:14px;margin-bottom:32px}
.co-card{background:#141926;border:1px solid #2A3148;border-radius:14px;padding:20px;cursor:pointer;transition:.2s;text-decoration:none;display:block;color:inherit}
.co-card:hover{border-color:var(--a1);transform:translateY(-2px);box-shadow:0 8px 24px rgba(0,0,0,.35)}
.co-name{font-size:15px;font-weight:700;color:#fff;margin-bottom:3px;display:flex;align-items:center;gap:8px;flex-wrap:wrap}
.co-email{font-size:12px;color:#8B95B0;margin-bottom:14px}
.co-stats{display:grid;grid-template-columns:1fr 1fr;gap:8px}
.co-stat{background:#0B0F1A;border-radius:8px;padding:10px 12px}
.co-stat .cs-label{font-size:10px;font-weight:600;color:#8B95B0;text-transform:uppercase;letter-spacing:.3px;margin-bottom:3px}
.co-stat .cs-val{font-size:15px;font-weight:700;color:#E8ECF4}
.you-badge{font-size:10px;background:var(--a1);color:#fff;padding:2px 7px;border-radius:10px;font-weight:700;flex-shrink:0}
.drill-panel{background:#141926;border:1px solid #2A3148;border-radius:16px;padding:24px;margin-bottom:24px}
.drill-header{display:flex;align-items:flex-start;gap:16px;margin-bottom:20px;padding-bottom:16px;border-bottom:1px solid #2A3148}
.drill-header-info h3{font-size:18px;font-weight:700;color:#fff}
.drill-header-info p{font-size:13px;color:#8B95B0;margin-top:3px}
.back-btn{display:inline-flex;align-items:center;gap:6px;padding:7px 14px;background:#2A3148;color:#E8ECF4;border-radius:8px;text-decoration:none;font-size:13px;font-weight:600;flex-shrink:0}
.back-btn:hover{background:#3A4158;color:#fff}
.table-wrap{overflow-x:auto}
table{width:100%;border-collapse:collapse}
th{padding:10px 14px;text-align:left;font-size:11px;font-weight:700;color:#8B95B0;text-transform:uppercase;letter-spacing:.5px;background:#0B0F1A;border-bottom:1px solid #2A3148;white-space:nowrap}
td{padding:11px 14px;font-size:13px;color:#C8D0E0;border-bottom:1px solid #1E2536}
tr:last-child td{border-bottom:none}
tr:hover td{background:#1a2035;color:#E8ECF4}
.empty-state{text-align:center;padding:48px 20px}
.empty-state .es-icon{font-size:40px;margin-bottom:12px}
.empty-state p{color:#8B95B0;font-size:14px}
.s-badge{display:inline-block;padding:3px 9px;border-radius:20px;font-size:11px;font-weight:600}
.s-badge.paid,.s-badge.active,.s-badge.signed,.s-badge.generated{background:rgba(74,222,128,.12);color:#4ADE80;border:1px solid rgba(74,222,128,.2)}
.s-badge.unpaid,.s-badge.draft,.s-badge.pending{background:rgba(251,191,36,.12);color:#FBBF24;border:1px solid rgba(251,191,36,.2)}
.s-badge.overdue,.s-badge.cancelled{background:rgba(248,113,113,.12);color:#F87171;border:1px solid rgba(248,113,113,.2)}
.s-badge.completed{background:rgba(59,130,246,.12);color:#60A5FA;border:1px solid rgba(59,130,246,.2)}

</style>
</head>
<body>
<div class="topbar">
  <div class="topbar-left">
    <a href="/" style="text-decoration:none"><h1>Proposal<span>Snap</span></h1></a>
    <span class="badge-admin">üëë ADMIN</span>
  </div>
  <div class="topbar-right">
    <a href="https://snapsuite.up.railway.app" target="_blank" class="suite">‚Üê Varnam Suite</a>
    
    <a href="/">Dashboard</a>
    <a href="/logout">Sign out</a>
  </div>
</div>
<div class="main">
  <div class="page-header">
    <h2>Platform Overview</h2>
    <p>All companies using ProposalSnap. Click a company to see their data.</p>
  </div>
  <div class="platform-stats">
    
    <div class="stat a1"><div class="s-label">Companies</div><div class="s-val">{{ platform.total_users }}</div></div>
    <div class="stat a2"><div class="s-label">Presentations</div><div class="s-val">{{ platform.total_presentations }}</div></div>
    <div class="stat a3"><div class="s-label">Slides Generated</div><div class="s-val">{{ platform.total_slides }}</div></div>
    <div class="stat a2"><div class="s-label">New This Week</div><div class="s-val">{{ platform.new_users_7d }}</div><div class="s-sub">companies</div></div>
    <div class="stat a1"><div class="s-label">Decks This Week</div><div class="s-val">{{ platform.presentations_7d }}</div></div>
    
  </div>
  {% if selected_company %}
  <div class="drill-panel">
    <div class="drill-header">
      <a href="/admin" class="back-btn">‚Üê Back</a>
      <div class="drill-header-info">
        <h3>{{ selected_company.company_name or selected_company.email }}</h3>
        <p>{{ selected_company.email }} ¬∑ Joined {{ selected_company.created_at.strftime('%b %d, %Y') if selected_company.created_at else '‚Äî' }}</p>
      </div>
    </div>
    
    {% if company_items %}
    <div class="table-wrap"><table>
      <thead><tr><th>Title</th><th>Type</th><th>Slides</th><th>Action</th><th>Date</th></tr></thead>
      <tbody>
      {% for r in company_items %}
      <tr>
        <td><strong>{{ r.title or 'Untitled' }}</strong></td>
        <td>{{ r.presentation_type or '‚Äî' }}</td>
        <td>{{ r.slides }}</td>
        <td>{{ r.action or 'generate' }}</td>
        <td>{{ r.created_at.strftime('%Y-%m-%d') if r.created_at else '‚Äî' }}</td>
      </tr>
      {% endfor %}
      </tbody>
    </table></div>
    {% else %}
    <div class="empty-state"><div class="es-icon">üéØ</div><p>No presentations yet for this company.</p></div>
    {% endif %}
    
  </div>
  {% endif %}
  <div class="section-header">
    <h3>All Companies</h3>
    <span class="count">{{ companies|length }} total</span>
  </div>
  <div class="companies-grid">
    {% for c in companies %}
    <a class="co-card{% if selected_company and c.id == selected_company.id %} active{% endif %}" href="/admin?company_id={{ c.id }}">
      <div class="co-name">
        {{ c.company_name or 'Unnamed Company' }}
        {% if c.id == user.id %}<span class="you-badge">You</span>{% endif %}
      </div>
      <div class="co-email">{{ c.email }}</div>
      <div class="co-stats">
        
        <div class="co-stat"><div class="cs-label">Decks</div><div class="cs-val">{{ c.presentation_count }}</div></div>
        <div class="co-stat"><div class="cs-label">Slides</div><div class="cs-val">{{ c.total_slides }}</div></div>
    
      </div>
    </a>
    {% endfor %}
  </div>
</div>
</body></html>